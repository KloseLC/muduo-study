内存屏障的原由来自于cpu的乱序执行


1 什么是乱序执行 
乱序执行就是让可以并行的 不相关的两行代码可以优先执行

如  
1  b = a + 5
2  c = b * 2
3  d = a * 2

那么CPU就会同时并发执行 1 和 3 ,因为他俩没有相关性,2是最后执行的 
目前较为高级的芯片上都是乱序执行  

那么问题来了,都这么乱序执行 怎么做同步呢?

2 内存屏障的作用

内存屏障就是cpu在内存的一个地址设置一个同步点,从begin到这个同步点的位置为乱序区间,一段段的内存处理完毕之后 开始一块的内存数据
乱序执行,到达内存屏障点结束

所以内存屏障是乱序执行引入的一个必要的手段,
将一段内存屏蔽起来进行乱序执行的计算而已
